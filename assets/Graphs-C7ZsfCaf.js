import{c as f,r as T,j as a,Y as P,C as g,T as b,a as E}from"./index-C3s0TpeY.js";import{s as j,S as F,B as L,a as R,b as G,C as O,G as _,D as S,T as M,c as W,d as Y,e as y,U as k,f as B,A as I,g as U,h as V,i as w,P as N,j as q,k as z,l as K,m as J,F as Q,n as X,o as Z,p as tt,q as et,r as st,t as nt}from"./Timeline-DhWEXSsB.js";import{a as at,S as $}from"./index-BjA5laHd.js";const ot=e=>"name"in e,v=(e,t)=>{switch(e){case"status":return j(t);default:return""}},rt={name:!1,status:!0,none:!1},lt=e=>{const t=f.c(12),{data:s,measure:o}=e,[n,r]=T.useState("none");let c;t[0]!==s||t[1]!==n||t[2]!==o?(c=x=>s.flatMap(it).map(d=>({date:x?d.startDate.toYearMonth():d.startDate.toYear(),colour:v(n,d.show),name:n==="none"?"":d.show[n],value:o==="Episodes"?d.e:d.minutes})),t[0]=s,t[1]=n,t[2]=o,t[3]=c):c=t[3];const l=c,i=o==="Episodes"?"Episodes Watched":"Hours Watched",m=o==="Hours"?mt:void 0;let u;t[4]===Symbol.for("react.memo_cache_sentinel")?(u=Object.keys(rt),t[4]=u):u=t[4];let p;t[5]!==n?(p=a.jsx(F,{options:u,value:n,setValue:r}),t[5]=n,t[6]=p):p=t[6];let h;return t[7]!==l||t[8]!==i||t[9]!==m||t[10]!==p?(h=a.jsx(L,{title:i,data:l,dataPostProcess:m,controls:p}),t[7]=l,t[8]=i,t[9]=m,t[10]=p,t[11]=h):h=t[11],h};function it(e){return e.s}function ct(e){return e&&Math.floor(e/60)}function ut(e){return e.map(ct)}function mt(e){return e.map(ut)}const pt=e=>{const t=f.c(10),{data:s,measure:o}=e;let n;t[0]===Symbol.for("react.memo_cache_sentinel")?(n=["status","startDate","show"],t[0]=n):n=t[0];const[r,c]=T.useState(n);let l;t[1]!==r||t[2]!==s||t[3]!==o?(l=ft(s.flatMap(xt),r,o),t[1]=r,t[2]=s,t[3]=o,t[4]=l):l=t[4];const i=l;let m;t[5]!==r?(m=a.jsx(R,{options:dt,controlStates:r,setControlStates:c}),t[5]=r,t[6]=m):m=t[6];let u;return t[7]!==i||t[8]!==m?(u=a.jsx(G,{data:i,controls:m}),t[7]=i,t[8]=m,t[9]=u):u=t[9],u},dt=["name","status","startDate","show","anime"],ht=e=>!!e.s,ft=(e,t,s)=>{const o=(l,i)=>i=="startDate"?l.startDate.yearString():i=="show"?l.show.name:i=="anime"?l.show.anime.toString():l.show[i],n=e.filter(l=>s!=="Hours"||l.minutes!==void 0).reduce((l,i)=>{const m=t.map(p=>o(i,p));let u=l;return m.forEach(p=>u=u[p]=u[p]||{}),u[`${i.show.name} - S${i.s}`]=i,l},{}),r=(l,i,m)=>Object.entries(l).sort(([u],[p])=>u.localeCompare(p)).reduce((u,[p,h])=>{if(ht(h)){const x=s==="Hours"?Math.floor(h.minutes/60):h.e,d=v(t[0],h.show)||void 0;u.total+=x,u.color=d,u.entries.push({name:p,parent:i,value:x,id:`${i}-${p}`,color:d})}else{const{total:x,color:d}=r(h,`${i}-${p}`,u.entries);u.total+=x,u.color=d,u.entries.push({name:p,parent:i,value:x,id:`${i}-${p}`,color:d})}return u},{total:0,color:void 0,entries:m}),{entries:c}=r(n,"",[]);return c};function xt(e){return e.s}const A=e=>{const t=f.c(10);let s,o;t[0]!==e?({item:s,...o}=e,t[0]=e,t[1]=s,t[2]=o):(s=t[1],o=t[2]);const n=ot(s)?s:s.show;let r;t[3]!==n?(r=l=>a.jsx(at,{sx:{background:l,color:i=>l&&i.palette.getContrastText(l)},children:a.jsxs(_,{container:!0,spacing:1,children:[a.jsx(jt,{colour:l,item:n}),a.jsx(S,{colour:l,label:"Start Date",value:n.startDate.toString()}),a.jsx(S,{colour:l,label:"End Date",value:n.endDate?.toString()}),a.jsx(S,{colour:j(n),label:"Status",value:n.status}),a.jsx(S,{colour:l,label:"Last Watched",value:`S${n.s.length}E${n.s.at(-1).e}`}),a.jsx(S,{colour:l,label:"Hours",value:Math.floor(n.minutes/60)}),a.jsx(S,{colour:l,label:"Episodes",value:n.e})]})}),t[3]=n,t[4]=r):r=t[4];let c;return t[5]!==o||t[6]!==n.banner||t[7]!==n.name||t[8]!==r?(c=a.jsx(O,{alt:n.name,image:n.banner,detailComponent:r,...o}),t[5]=o,t[6]=n.banner,t[7]=n.name,t[8]=r,t[9]=c):c=t[9],c},C=P.get(2008,1,1),D=C.daysTo(g),jt=({colour:e,item:t})=>{if(!t.startDate||t.startDate<C)return null;let s=C;const o=t.s.flatMap((n,r)=>{const c=[];if(s<n.startDate){const u=s.daysTo(n.startDate)/D*100;c.push(a.jsx(M,{percent:u},`${n.s}-before`))}const l=n.endDate??g,i=Math.max(n.startDate.daysTo(l)/D*100,.5);return c.push(a.jsx(W,{percent:i,backgroundColour:[`${r%2===0?"secondary":"primary"}.light`,`${r%2===0?"secondary":"primary"}.main`],tooltip:a.jsxs(a.Fragment,{children:[a.jsxs(b,{variant:"h6",align:"center",children:["S",n.s]}),a.jsxs(b,{children:[n.startDate.toString()," - ",l.toString()]}),a.jsxs(b,{children:[n.e," Episodes"]}),a.jsxs(b,{children:[Math.floor(n.minutes/60)," Hours"]})]})},n.s)),s=l.increment(),c});if(s<g){const r=s.daysTo(g)/D*100;o.push(a.jsx(M,{percent:r},"last"))}return a.jsx(Y,{segments:o,colour:e})},St=e=>{const t=f.c(2),{data:s}=e;let o;return t[0]!==s?(o=a.jsxs(_,{container:!0,spacing:1,alignItems:"stretch",children:[a.jsx(bt,{data:s}),a.jsx(yt,{data:s}),a.jsx(Dt,{data:s}),a.jsx($t,{data:s}),a.jsx(gt,{data:s}),a.jsx(_t,{data:s}),a.jsx(Ct,{data:s})]}),t[0]=s,t[1]=o):o=t[1],o},gt=e=>{const t=f.c(4),{data:s}=e;let o;t[0]===Symbol.for("react.memo_cache_sentinel")?(o=["Watching","Up To Date","Ended","Cancelled","Abandoned"],t[0]=o):o=t[0];const n=o;let r;t[1]===Symbol.for("react.memo_cache_sentinel")?(r=a.jsx(U,{}),t[1]=r):r=t[1];let c;return t[2]!==s?(c=a.jsx(_,{size:12,children:a.jsx($,{justifyContent:"space-between",height:"100%",spacing:1,children:a.jsx(V,{title:"Status",icon:r,data:s,groupKey:"status",group:n,groupToColour:Mt,measureLabel:"Shows"})})}),t[2]=s,t[3]=c):c=t[3],c},bt=e=>{const t=f.c(13),{data:s}=e,o=s.length;let n;t[0]!==s?(n=s.sum("e"),t[0]=s,t[1]=n):n=t[1];const r=n,c=Math.floor(s.sum("minutes")/60);let l;t[2]===Symbol.for("react.memo_cache_sentinel")?(l=a.jsx(w,{}),t[2]=l):l=t[2];let i;t[3]!==o?(i=["Shows",o],t[3]=o,t[4]=i):i=t[4];let m;t[5]!==r?(m=["Episodes",r],t[5]=r,t[6]=m):m=t[6];let u;t[7]!==c?(u=["Hours",c],t[7]=c,t[8]=u):u=t[8];let p;return t[9]!==i||t[10]!==m||t[11]!==u?(p=a.jsx(y,{icon:l,title:"All Time",content:[i,m,u]}),t[9]=i,t[10]=m,t[11]=u,t[12]=p):p=t[12],p},yt=({data:e})=>{const t=e.flatMap(r=>r.s).filter(r=>r.startDate.year===E),s=t.length,o=t.sum("e"),n=Math.floor(t.sum("minutes")/60);return a.jsx(y,{icon:a.jsx(k,{}),title:`In ${E}`,content:[["Seasons",s],["Episodes",o],["Hours",n]]})},Dt=({data:e})=>{const t=e.flatMap(r=>r.s).reduce((r,c)=>{if(!c.minutes)return r;const l=c.startDate.year;return r[l]??={seasons:0,episodes:0,minutes:0},r[l].seasons+=1,r[l].episodes+=c.e,r[l].minutes+=c.minutes,r},{}),s=Math.floor(Object.values(t).sum("seasons")/Object.keys(t).length),o=Math.floor(Object.values(t).sum("episodes")/Object.keys(t).length),n=Math.floor(Object.values(t).sum("minutes")/Object.keys(t).length/60);return a.jsx(y,{icon:a.jsx(B,{}),title:"Yearly Average",content:[["Seasons",s],["Episodes",o],["Hours",n]]})},$t=({data:e})=>{const t=e.flatMap(r=>r.s),s=Math.round(t.length/e.length),o=Math.round(t.sum("e")/e.length),n=Math.floor(t.sum("minutes")/60/e.length);return a.jsx(y,{icon:a.jsx(I,{}),title:"Show Average",content:[["Seasons",s],["Episodes",o],["Hours",n]]})},Ct=e=>{const t=f.c(7),{data:s}=e;let o;t[0]!==s?(o=s.flatMap(wt).filter(vt).sort(At).slice(0,6),t[0]=s,t[1]=o):o=t[1];const n=o;let r;t[2]===Symbol.for("react.memo_cache_sentinel")?(r=a.jsx(N,{}),t[2]=r):r=t[2];let c,l;t[3]===Symbol.for("react.memo_cache_sentinel")?(c=[12,12,12],l=[6,4,2],t[3]=c,t[4]=l):(c=t[3],l=t[4]);let i;return t[5]!==n?(i=a.jsx(H,{icon:r,title:"Recently Finished",content:n,width:c,pictureWidth:l,chipComponent:Ht,labelComponent:Tt}),t[5]=n,t[6]=i):i=t[6],i},Tt=e=>[[`S ${e.s}`,e.endDate?.toString()??""],[`${e.e} Eps`,`${q(Math.round(e.minutes/60))} Hours`]],_t=e=>{const t=f.c(7),{data:s}=e;let o;t[0]!==s?(o=s.filter(Pt).map(Ft).filter(Lt).sort(Rt),t[0]=s,t[1]=o):o=t[1];const n=o;let r;t[2]===Symbol.for("react.memo_cache_sentinel")?(r=a.jsx(z,{}),t[2]=r):r=t[2];let c,l;t[3]===Symbol.for("react.memo_cache_sentinel")?(c=[12,12,12],l=[6,4,2],t[3]=c,t[4]=l):(c=t[3],l=t[4]);let i;return t[5]!==n?(i=a.jsx(H,{icon:r,title:"Currently Watching",content:n,width:c,pictureWidth:l,labelComponent:Et}),t[5]=n,t[6]=i):i=t[6],i},Et=e=>[[`S ${e.s}`,e.startDate?.toString()??""]],H=e=>a.jsx(K,{MediaComponent:A,nameComponent:t=>t.show.name,...e});function Mt(e){return j({status:e})}function wt(e){return e.s}function vt(e){return e.endDate}function At(e,t){return e.endDate<t.endDate?1:-1}function Ht(e){const{show:t}=e;return[t.status,j(t)]}function Pt(e){return e.status==="Watching"}function Ft(e){return e.s.at(-1)}function Lt(e){return!e.endDate}function Rt(e,t){return e.startDate<t.startDate?1:-1}const Gt=e=>{const t=f.c(9),{data:s}=e,[o,n]=T.useState(!0);let r;t[0]!==s||t[1]!==o?(r=(o?s.map(Wt):s.flatMap(Yt)).map(kt),t[0]=s,t[1]=o,t[2]=r):r=t[2];const c=r;let l;t[3]===Symbol.for("react.memo_cache_sentinel")?(l=(u,p)=>n(p),t[3]=l):l=t[3];let i;t[4]!==o?(i=a.jsx(J,{title:"Timeline",action:a.jsx(Q,{row:!0,children:a.jsx(X,{label:"Combine Seasons",control:a.jsx(Z,{checked:o,onChange:l})})})}),t[4]=o,t[5]=i):i=t[5];let m;return t[6]!==c||t[7]!==i?(m=a.jsx(tt,{data:c,children:i}),t[6]=c,t[7]=i,t[8]=m):m=t[8],m},Ot=(e,t,s)=>`
  <div style="display: flex;" class="backgroundPaper">
    ${s?`<img src="${s}" style="height: 150px" /><hr />`:""}  
    <div>     
      <ul style="list-style-type: none;padding: 5px">
        <li>
          <span><b>${e}</b></span>
        </li>
      </ul>
      <hr />
      <ul style="list-style-type: none;padding-left: 10px">
        <li>
          <span><b>Hours: </b></span>
          <span">${Math.round(t.minutes/60)}</span>
        </li>
        <li>
          <span><b>Period: </b></span>
          <span>${t.startDate.toString()} - ${t.endDate?.toString()||"present"} </span>
        </li>
        <li>
          <span><b>Episodes: </b></span>
          <span>${t.e}</span>
        </li>
      </ul>
    </div>     
  </div>
  `;function Wt(e){return[e.name,e,j(e),e.banner]}function Yt(e){return e.s.map(t=>[`${e.name} - S${t.s}${t.subtitle?" - "+t.subtitle:""}`,t,j(e),e.banner])}function kt(e){const[t,s,o,n]=e;return{row:"*",name:t,tooltip:Ot(t,s,n),colour:o,start:s.startDate.toDate(),end:s.endDate?.toDate()??g.toDate()}}const Vt=({data:e,filterState:t,filterDispatch:s})=>a.jsxs(a.Fragment,{children:[a.jsxs($,{spacing:2,children:[a.jsx(St,{data:e}),a.jsx(Gt,{data:e}),a.jsx(lt,{data:e,measure:t.measure}),a.jsx(pt,{data:e,measure:t.measure}),a.jsx(et,{title:"All Shows",data:e,width:3,colour:j,MediaComponent:A})]}),a.jsx($,{direction:"column",spacing:2,sx:{position:"fixed",right:o=>o.spacing(2),bottom:o=>o.spacing(2)},children:a.jsx(st,{color:"secondary",onClick:()=>s({type:"toggleMeasure"}),children:t.measure==="Episodes"?a.jsx(nt,{}):a.jsx(w,{})})})]});export{Vt as default};
//# sourceMappingURL=Graphs-C7ZsfCaf.js.map
